---
title: "Week7"
subtitle: "Clustering"
author: Segard Neil
date: "`r format(Sys.time())`"
output: 
  html_notebook:
    toc: true
    toc_depth: 2
    theme: flatly
---
```{r}
library(knitr)
library(dplyr)
```
***
# Q1 Reading file
```{r}
file <- "ligue1_17_18.csv"
data <- read.csv(file, sep =";", row.names= 1)
```

***
# Q2 Printing dataframe infos
```{r}
print(head(data, 2))
```

```{r}
print(nrow(data))
```

```{r}
test <- knitr::kable(data[1:5,1:5])
print(head(test))
```


***
# Q3 Extracting columns
```{r}
pointsCards <- select(data, "Points", "yellow.cards")
print(head(pointsCards))
```

***
# Q4 Applying kmeans
```{r}
k<-2

km <- kmeans(pointsCards, k, iter.max = 20, nstart = 1,
       algorithm = c("Hartigan-Wong", "Lloyd", "Forgy",
                     "MacQueen"), trace=FALSE)
```

***
# Q5 Description of km
```{r}
print(head(km))
```
kmeans returns an object of class "kmeans". Here we have:

> cluster: A vector of integers (from 1:k) indicating the cluster to which each point is allocated.
> 
> centers: A matrix of cluster centres.
> 
> totss: The total sum of squares.
> 
> withinss: Vector of within-cluster sum of squares, one component per cluster.
> 
> tot.withinss: Total within-cluster sum of squares.
> 
> betweenss: The between-cluster sum of squares.


***
# Q6 Centers
Here are the centers
```{r}
print(km$centers)
```
***

# Q7&8 Plotting centers
```{r}
plot(pointsCards, col = km$cluster)
points(km$centers, pch=11)
text(x = pointsCards, labels = rownames(pointsCards), col = km$cluster,
     pos = 3, cex = 0.75)
```


***
# Q9 More kmeans
```{r}
k<-3

km <- kmeans(pointsCards, k, iter.max = 20, nstart = 1,
       algorithm = c("Hartigan-Wong", "Lloyd", "Forgy",
                     "MacQueen"), trace=FALSE)
plot(pointsCards, col = km$cluster)
points(km$centers, pch=11)
text(x = pointsCards, labels = rownames(pointsCards), col = km$cluster,
     pos = 3, cex = 0.75)
```

```{r}
k<-4

km <- kmeans(pointsCards, k, iter.max = 20, nstart = 1,
       algorithm = c("Hartigan-Wong", "Lloyd", "Forgy",
                     "MacQueen"), trace=FALSE)
plot(pointsCards, col = km$cluster)
points(km$centers, pch=11)
text(x = pointsCards, labels = rownames(pointsCards), col = km$cluster,
     pos = 3, cex = 0.75)
```




























